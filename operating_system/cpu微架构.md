# CPU微架构

## 流水线

对于一条指令来说，每套指令都会分成不同的部分，基本是 `取指 - 译码 - 执行 - 访存 - 回写`， 在流水线上并不是执行完这一通操作之后才执行下一个指令，而是类似于汽车流水线一样进行执行，

## 乱序执行

- 程序在执行的时候，其结果是按照程序写的代码一样，往下执行，但是在指令上方，他其实是乱序执行的（多线程加锁的原因之一吧。单个线程乱序执行没事，但是多个线程之间的数据要是有访问冲突了，那么指令就会有冲突），就好像所有的指令是按照顺序执行的。`但是为了保证正确性，所有的数据都要保证按照同一顺序进行退休(就是执行完毕)`，`主要保证了因为指令之间有依赖关系而导致停顿引起来的性能损耗` 
- 相关硬件
  - 计分板（按照退休状态保证所有指令退休的一致性，
  - 寄存器重命名

## 超标量和超长指令集

cpu在运行的时候，在流水线上，指令可以按照顺序执行，如今，可以两条指令一起顺序执行，现代cpu一般是2-4？

## 分支预测

在做选择条件的时候，cpu可以进行分支预测，如果预测正确的话，那么会节省大量的时间，但是如果出现了错误，那么就会收到惩罚。

## 缓存

cpu中哪都有缓存，内存可以当成硬盘的缓存，最小的单位是`cache line`，是64字节，即最少进行交互的信息是64字节，

### 缓存的读取和失效

待补充

