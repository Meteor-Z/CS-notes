 # Java Web

`B/S`架构: 浏览器/服务器模式，两者之间直接把这个信息进行处理就可以了，易于维护和升级

## HTTP

HTTP：规定了浏览器和服务器之间的数据传输的规则

- 基于`TCP`协议，面向连接，十分安全
  - 每次请求是独立的，所有不能共享，但是速度更快 （使用`Cookie`,`Session`来解决此缺点）

### 常见的数据格式

- 数据分成三部分

  - 请求行：第一行，其中`GET`表示的是请求方式/表示请求资源的路径,还有请求协议
  - 请求头，第二行开始，格式是`key:value`的格式
  - 请求体：`POST`请求的最后一部分，存放的是请求参数

- 响应数据的格式

  - 响应行：响应的状态，200 就是OK，
  - 响应头：`key:value`的值
  - 响应体：存放着响应数据

- 状态码：

  - `1xx`:响应中，临时状态吗，
  - `2xx`:都表示成功，处理已经完成
  - `3xx`：重定向到了其他地方
  - `4xx`:客户端错误
  - `5xx`:服务器发生错

  

  

  

## 创建`maven`项目

### 项目构造

1. 对于开发中的项目
   - hello
     - src
       - main
         - java
         - resources
         - webapp
           - html （外界能访问的）
           - WEB-INF (WEB的配置文件)
             - web.xml
     - pom.xml

2. 部署的`JavaWeb`项目构造：

   - hello
     - html
     - WEB-INF
       - classes (java字节码文件)
       - lib（项目所需要的jar包）
         - web.xml （web项目配置文件）

   



### 请求转发

一种在服务器内部发生资源跳转的方式

`request.getRequestDispatcher("/demo02").forward(request,response);`

同时，我们可以将资源放在request里面。然后进行转发

- `setAttribute` ：设置域

- `getAttribute`：根据key,来获取

- `removeAttribute`

重定向：我自己处理不了，我302了，现在需要你照其他人，然后我会给你一个地址。就是响应头`location:XXXX`

特点：

- 地址栏会发生变化，但是请求转发的话不会发生改变
- 可以重定向向很多位置，其他网站也可以了的

路径问题：

- 浏览器使用：不需要加虚拟路径（就是不加项目访问路径）
- 服务端使用：不需要加虚拟路径（自己使用就可以了）
- 练习：
  - `<a>`:浏览器使用，所以要加上虚拟路径
  - `<form>`：浏览器使用，加上虚拟路径
  - 转发：不需要加虚拟路径
  - 重定向：需要加上虚拟路径

### response

- 响应行： `setSatus(int sc)`:设置状态码
- 响应头： `set Header(String name,String value)`： 设置响应键值对
- 响应体: 通过流的形式将输入输出流输出到界面就行了



#  EL表达式

- 用于简化JSP页面内的代码
- 主要功能：获取数据
- 语法：`${expression}` 获取域中存储的的key为expression的数据

# MVC模式和三层架构

## MVC模式

- M Model:业务模型，处理业务
- V View:视图，界面展示
- C Controller,控制器，处理请求，调用模型和视图

好处

- 职责单一，互不影响
- 有利于分工协作
- 有利于组建重用

## 三层架构

- 表现层 ： `com.lzc.web.controller`   `SpringMVC`
- 业务逻辑层:`com.lzc.service`   `Spring`
- 数据访问层：`con.lzc.dao/mapper`  `MyBatis`

其实就是将业务分开，如果有一个东西寄了，那么其他的不会改变，其他的都弄好了就行了

然后这三个东西就是`SSM` 



# 会话跟踪技术

会话：用户打开浏览器，访问`web`服务器的资源，会话建立，直到有一方断开连接，会话结束，在一次会话中可以包含多次请求和响应

会话跟踪：维护浏览器状态的方法，服务器需要识别多次请求是否来自同一浏览器，以便在同一次会话的多次请求之间共享数据

是不是就是`cookie`?

服务器很多请求，但是不知道请求1 和请求2 是否是一个同一个人，（因为是`http`协议，所以说不能判断是否来自同一个人） 这时候需要一个技术:`Session`和`Cookie` 就可以了

- 客户端会话跟踪技术：`Cookie`
- 服务端会话技术：`Seesion` 这是放在服务器里面了吗?(还是说放在数据库里面)

## Cookie

`Cookie`:客户端会话技术，保存在客户端里面，每一次请求会携带`Cooke`数据进行访问，这样就可以携带相关信息

我们就要发送`Cookie`和获取`Cookie`就行了

`Cookie`会保存一段时间





## Cookie 原理

- `Cookie`的实现是基于`HTTP`协议的
  - 响应头：`set-cookie` 
  - 请求头：`cookie`



## `Cookie`的存放时间（持久化）

- 默认情况下：`Cookie`存储在浏览器中，浏览器关闭，内存释放，那么`Cookie`就会被销毁
- `setMaxAge(int seconds)` 设置`Cookie`的存放时间
  - 正数：存放时间
  - 负数：默认的，
  - 0：删除对应的`Cookie`

## `Cookie`存放中文?

我觉得不需要吧？谁存放中文丫？



## `Session`

服务端会话跟踪技术：将数据保存到服务端

`Seesion`也是基于`Cookie`的,

- 服务器正常关闭之后，会自动将`Seeion`存放在硬盘里面就行了
- 然后服务器启动之后，`Session`就会活化

