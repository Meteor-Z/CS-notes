# rpc

## 设置一个好的rpc协议

因为tcp协议只是将内容从A传递到B,并没有规定数据边界，需要自己实现一个协议，表示协议长度，所以要有协议长度和协议体，并且为了以后的可扩展性，需要设置一个可扩展的协议体。
所以要有一定的可变长度，否则超出数据边界的话，就会发生错误。

## 传输

传输的时候，要考虑这几个方面

- 安全
- 通用性
- 兼容性：肯定要向后兼容
- 性能
- 效率
- 空间开销：网络传输需要消耗一定的网络资源

### 序列化和反序列化

A端通过网络调用B端口的参数，需要将调用参数进行数据化成二进制数据（网络中传输的就是二进制数据），然后将数据发送到B端之后，再反序列化成参数数据就可以直接调用了。

#### 用什么序列化

- json：开销比较大，需要比较大的内存和磁盘开销。并且相当于一个个的字符串（kv)存储，而且不是强类型
- hessian: 没听说过，
- protobuf:以后要用的

### 传输注意事项

1. 对象简单，没有太多依赖，属性不要过多，高内聚，低耦合
2. 入参对象与返回值对象不要过大，不要传入过大的集合
3. 尽量使用简单，常用，原生对象
4. 必要有复杂的继承关系。

## 网络模型

肯定要优先使用非堵塞的模型
